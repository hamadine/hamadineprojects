let recoActive = false;

function activerMicroEtComparer() {
  if (!('webkitSpeechRecognition' in window)) {
    alert("ğŸ¤ Reconnaissance vocale non prise en charge sur ce navigateur.");
    return;
  }

  const motAttendu = mots[indexMot]?.mot?.toLowerCase();
  if (!motAttendu) return;

  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'fr-FR'; // Peut Ãªtre adaptÃ© selon les sons Tadaksahak

  recognition.onstart = () => {
    recoActive = true;
    afficherMessage('bot', "ğŸ™ï¸ Parlez maintenant...");
  };

  recognition.onresult = (event) => {
    const result = event.results[0][0].transcript.trim().toLowerCase();
    console.log("Tu as dit :", result);

    const correct = result === motAttendu;
    if (correct) {
      afficherMessage('bot', `âœ… Bien dit ! Tu as prononcÃ© <strong>${result}</strong> comme attendu.`);
    } else {
      afficherMessage('bot', `âŒ Tu as dit : <strong>${result}</strong><br>ğŸ” Attendu : <strong>${motAttendu}</strong>`);
    }
  };

  recognition.onerror = (e) => {
    afficherMessage('bot', "âŒ Erreur de reconnaissance vocale.");
  };

  recognition.onend = () => recoActive = false;
  recognition.start();
}

document.getElementById('btnPrononcer').addEventListener('click', activerMicroEtComparer);
